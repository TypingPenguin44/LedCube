<!DOCTYPE HTML><html>
<head>
	<meta name="viewport" charset="UTF-8" content="width=400px">

	<title>LedCube</title>
	<style>
		/*<meta name="viewport" charset="UTF-8" content="width=device-width, initial-scale=1">*/
		table {
			width: 100%;
			max-width: 400px;
		}
		td{
			width: 180px;
		}
		html {
			font-family: Arial;
			display: inline-block;
			text-align: center;
		}
		p {
			font-size: 1rem;
			color: #FFFFFF;}
		body {
			max-width: 400px;
			background-color: #36393e;
			margin:0px auto;
			padding-bottom: 25px;
			font-family: sans-serif;
			color: #bfbfbf;}
		.sliders { 
			-webkit-appearance: none;
			margin: auto;
			width: 88%;
			height: 25px;
			background: #2f3136;
		    outline: none;
			max-width: 400px;
		    -webkit-transition: .2s;
		    transition: opacity .2s;}
		.sliders::-webkit-slider-thumb {
			-webkit-appearance: none;
			appearance: none;
			width: 35px;
			height: 35px;
			background: #fcfc00;
			cursor: pointer;}
		.sliders::-moz-range-thumb { 
			width: 35px; 
			height: 35px; 
			background: #fff200; 
			cursor: pointer;} 

		.textbox{
			background-color: #2f3136;
			color: #bfbfbf;}
		.button{
			width: 90px;
			height: 50px;
			padding: 10px 20px;
			border: none;
			border-radius: 4px;
			color: #bfbfbf;
			background-color: #2f3136;
			/*padding: 0px 0px;*/
			text-align: center;
			text-decoration: none;
			display: inline-block;
			font-size: 12px;
			margin: 4px 2px;
			cursor: pointer;
		}
		button:hover {
			background: #42444a;
			cursor: pointer;
		}
		button:focus{
			background-color: #2f3136;
		}
		/*.button1 {
			background-color: #79808c;
		}*/
		.button2 {
			width:60px;
			height:25px;
		}
		.collapsible {
			background-color: #2f3136;;
			color: white;
			cursor: pointer;
			padding: 18px;
			width: 100%;
			max-width: 400px;
			border: none;
			text-align: left;
			outline: none;
			font-size: 15px;
		}
		.active, .collapsible:hover {
			background-color: #42444a;
		}
		.collapsible:after {
			content: '\002B';
			color: white;
			font-weight: bold;
			float: right;
			margin-left: 5px;
		}
		.active:after {
			content: "\2212";
		}
		.content {
			/*padding: 0 18px;*/
			max-height: 0;
			overflow: hidden;
			transition: max-height 0.2s ease-out;
		}
		.redtext{
			color: #F04747;
		}
		.purpletext{
			color: #7c30c2;
		}
		.cyantext{
			color: #0af0ec;
		}
		.orangetext{
			color: #ff7700;
		}
		.presettext, .greentext{
			color: #27f554;
		}
		.colorSample{
			background-color: #0af0ec;
		}
		.title {
			text-shadow: 2px 2px 4px #000000;			
			animation: rainbow 5s infinite; 
		}
		/* Chrome, Safari, Opera */
		@-webkit-keyframes rainbow{
			0%{color: orange;}	
			10%{color: purple;}	
			20%{color: red;}
			30%{color: CadetBlue;}
			40%{color: yellow;}
			50%{color: coral;}
			60%{color: green;}
			70%{color: cyan;}
			80%{color: DeepPink;}
			90%{color: DodgerBlue;}
			100%{color: orange;}
		}
		/* Standar Syntax */
		@keyframes rainbow{
			0%{color: orange;}	
			10%{color: purple;}	
			20%{color: red;}
			30%{color: CadetBlue;}
			40%{color: yellow;}
			50%{color: coral;}
			60%{color: green;}
			70%{color: cyan;}
			80%{color: DeepPink;}
			90%{color: DodgerBlue;}
			100%{color: orange;}
		}
	</style>
</head>
<body>
	<table>
		<tr>
			<td><p class="title cyantext"><b>LedCube</b></p></td>
			<td><p>Battery: <span id='percent'></span></p></td>
		</tr>
		<tr>
			<td><p>Rainbow</p></td>
			<td><button class="button orangetext" type="button" onclick="anim(0,0)">Rainbow</button></td>
		</tr>
		<tr>
			<td><p>Snake</p></td>
			<td><button class="button orangetext" type="button" onclick="anim(1,0)">Rainbow</button></td>
			<td><button class="button presettext" type="button" onclick="anim(1,0,1)">Static</button></td>
		</tr>
		<tr>
			<td><p>Snake++</p></td>
			<td><button class="button orangetext" type="button" onclick="anim(2,0)">Rainbow</button></td>
			<td><button class="button presettext" type="button" onclick="anim(2,0,1)">Static</button></td>
		</tr>
		<tr>
			<td><p>Donut</p></td>
			<td><button class="button orangetext" type="button" onclick="anim(3,0)">Rainbow</button></td>
			<td><button class="button presettext" type="button" onclick="anim(3,0,1)">Static</button></td>
		</tr>
    <tr>
			<td><p>Diagonal</p></td>
			<td><button class="button orangetext" type="button" onclick="anim(4,0)">Rainbow</button></td>
			<td><button class="button presettext" type="button" onclick="anim(4,0,1)">Static</button></td>
		</tr>
    <tr>
			<td><p>Dpad</p></td>
			<td><button class="button orangetext" type="button" onclick="anim(5,0)">Rainbow</button></td>
			<td><button class="button presettext" type="button" onclick="anim(5,0,1)">Static</button></td>
		</tr>
		<tr>
			<td><p>Fade</p></td>
			<td></td>
			<td><button class="button presettext" type="button" onclick="anim(11,0,1)">Static</button></td>
		</tr>
		<tr>
			<td><p>Static</p></td>
			<td></td>
			<td><button class="button presettext" type="button" onclick="anim(12,0,1)">Static</button></td>
		</tr>
	</table>
	<p></p>
  <button type="button" class="collapsible">Reactive Animaions</button>
  <div class="content">
    <table>
      <tr>
        <td><p>Dice</p></td>
        <td><button class="button orangetext" type="button" onclick="anim(6,1)">Rainbow</button></td>
        <td><button class="button presettext" type="button" onclick="anim(6,1,1)">Static</button></td>
      </tr>
      <tr>
        <td><p>Bubble</p></td>
        <td><button class="button orangetext" type="button" onclick="anim(7,1)">Rainbow</button></td>
        <td><button class="button presettext" type="button" onclick="anim(7,1,1)">Static</button></td>
      </tr>
      <tr>
        <td><p>Loading</p></td>
        <td><button class="button orangetext" type="button" onclick="anim(8,1)">Rainbow</button></td>
        <td><button class="button presettext" type="button" onclick="anim(8,1,1)">Static</button></td>
      </tr>
      <tr>
        <td><p>Lines</p></td>
        <td><button class="button orangetext" type="button" onclick="anim(9,1)">Rainbow</button></td>
        <td><button class="button presettext" type="button" onclick="anim(9,1,1)">Static</button></td>
      </tr>
    </table>
  </div>
	<button type="button" class="collapsible">Static Color Selection</button>
	<div class="content">
		<p><input type="range" id="hSlider" onchange="updateSlider(this)" min="0" max="1" value="0" step="0.004" class="sliders"></p>
		
		<p><input type="range" id="sSlider" onchange="updateSlider(this)" min="0" max="1" value="1" step="0.004" class="sliders"></p>
		
		<p><input type="range" id="vSlider" onchange="updateSlider(this)" min="0" max="1" value="1" step="0.004" class="sliders"></p>
		<table>
			<tr>
				<td style="width:100px;"><p>H: <span id="h">0</span></p></td>
				<td style="width:100px;"><p>S: <span id="s">1</span></p></td>
				<td style="width:100px;"><p>V: <span id="v">1</span></p></td>
        <td style="width:100px; background-color: transparent;" id="sample" name="sample" ></td>
			</tr>
		</table>
	</div>
	<p></p>
	<table>
		<tr>
			<td><button class="button button1 " type="button" onclick="press()"><b>Press</b></button></td>
			<td><button class="button button1 " type="button" onclick="double_press()"><b>Double Press</b></button></td>
			<td><button class="button button1 " type="button" onclick="long_press()"><b>Sleep</b></button></td>
		</tr>
	</table>
	<p></p>
	<button type="button" class="collapsible">Advanced</button>
	<div class="content">
		<p><input type="range" id="delay" onchange="" min="0" max="255" value="0" step="1" class="sliders"></p>
		<table>
			<tr>
				<td style="width:100px;"><span id="delayFeedback"></span></td>
				<td style="width:100px;"><button class="button button1" type="button" onclick="set_delay()"><b>Set Delay</b></button></td>
				<td style="width:100px;"><button class="button button1" type="button" onclick="reset_delay()"><b>Reset Delay</b></button></td>
        <td style="width:100px;"><button class="button button1" type="button" onclick="save_delay()"><b>Save Delay</b></button></td>
			</tr>
    </table>
    <table>
			<tr>
				<td><button class="button button1 orangetext" type="button" onclick="reload()"> <b>Reload Config</b></button></td>
        <td><button class="button button1 redtext" type="button" onclick="save_config()"><b>SAVE ALL</b></button></td>
				<td><button class="button button1 redtext" type="button" onclick="off()"><b>OFF</b></button></td>
        <td><button class="button button1 cyantext" type="button" onclick="charge()"><b>Charge</b></button></td>
			</tr>
		</table>
	</div>
	<button type="button" class="collapsible">Toggles</button>
		<div class="content">
			<table>
				<tr>
					<td><p>Shake to cycle</p></td>
					<td><button class="button button1 greentext" type="button" onclick="enable(0)"><b>Enable</b></button></td>
					<td><button class="button button1 redtext" type="button" onclick="disable(0)"><b>Disable</b></button></td>
				</tr>
			</table>
		</div>
<script>
/*Loading battery precentage/value*/
window.onload = function useless(){
	update_battery();
}
setInterval(update_battery, 10000);

function update_battery(){  
	ajaxLoad('getPercent'); 
}

var ajaxRequest = null;
if (window.XMLHttpRequest){
	ajaxRequest = new XMLHttpRequest();
} else {
	ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
}

function ajaxLoad(ajaxURL){
	if(!ajaxRequest){
		alert('AJAX is not supported.'); 
		return; 
	}

	ajaxRequest.open('GET',ajaxURL,true);
	ajaxRequest.onreadystatechange = function(){
		if(ajaxRequest.readyState == 4 && ajaxRequest.status==200){
			var ajaxResult = ajaxRequest.responseText;
			document.getElementById('percent').innerHTML = ajaxResult;
		}
	}
	ajaxRequest.send();
}

/*collapsible things*/
var coll = document.getElementsByClassName("collapsible");
var i;

for (i = 0; i < coll.length; i++) {
  coll[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var content = this.nextElementSibling;
    if (content.style.maxHeight){
      content.style.maxHeight = null;
    } else {
      content.style.maxHeight = content.scrollHeight + "px";
    } 
  });
}

//update sliders feedback
const delayIn = document.getElementById("delay");
const delayOut = document.getElementById("delayFeedback");
delayOut.innerHTML = delayIn.value;
delayIn.oninput = function() {
  delayOut.innerHTML = this.value;
}

const hSlider = document.getElementById("hSlider");
const hOutput = document.getElementById("h");
hSlider.oninput = function() {setSample(hSlider, hOutput)};

const sSlider = document.getElementById("sSlider");
const sOutput = document.getElementById("s");
sSlider.oninput = function() {setSample(sSlider, sOutput)};

const vSlider = document.getElementById("vSlider");
const vOutput = document.getElementById("v");
vSlider.oninput = function() {setSample(vSlider, vOutput)};



function hsvToRgb(h, s, v){
  h=h*255;
  s=s*255;
  v=v*255;
  var r, g, b;

  var i = Math.floor(h * 6);
  var f = h * 6 - i;
  var p = v * (1 - s);
  var q = v * (1 - f * s);
  var t = v * (1 - (1 - f) * s);

  switch (i % 6) {
    case 0: r = v, g = t, b = p; break;
    case 1: r = q, g = v, b = p; break;
    case 2: r = p, g = v, b = t; break;
    case 3: r = p, g = q, b = v; break;
    case 4: r = t, g = p, b = v; break;
    case 5: r = v, g = p, b = q; break;
  }

  var color = new String("rgb(" + Math.round(r * 255) + ", " + Math.round(g * 255) + ", "+ Math.round(b * 255) + ")");
  return color;
}


function setSample(slider, output){
  output.innerHTML = slider.value;
  //var color = new String("hsl(" + Math.round(hSlider.value / 255) + ", " + Math.round(sSlider.value / 255 * 100) + "%, "+ Math.round(vSlider.value / 255 * 100) + "%)");
  //console.log(color);
  var element = document.getElementById("sample");
  element.style.backgroundColor = hsvToRgb(hSlider.value / 255, sSlider.value / 255, vSlider.value / 255);
}

/*sending values back*/
function updateSlider() {

	var hSliderValue = document.getElementById("hSlider").value;
	var sSliderValue = document.getElementById("sSlider").value;
	var vSliderValue = document.getElementById("vSlider").value;

	//console.log(hSliderValue);
	//console.log(sSliderValue);
	//console.log(vSliderValue);

	var xhr = new XMLHttpRequest();
	xhr.open("GET", "/colors?h=" + hSliderValue + "&s=" + sSliderValue + "&v=" + vSliderValue, true);
	xhr.send();
}

/*other functions*/

function anim(id, mode, static = 0){
  if(static == 1){
    console.log(hSlider.value);
    console.log(sSlider.value);
    console.log(vSlider.value);

    var xhr = new XMLHttpRequest();
    xhr.open("GET", "/static?id=" + id + "&mode=" + mode + "&h="+ hSlider.value + "&s=" + sSlider.value + "&v=" + vSlider.value, true);
    xhr.send();
  }else{
    var xhr = new XMLHttpRequest();
	  xhr.open("GET", "/anim?id=" + id + "&mode=" + mode, true);
	  xhr.send();
  }
}

function press(){
	var xhr = new XMLHttpRequest();
	xhr.open("GET", "/press" , true);
	xhr.send()
}
function double_press(){
	var xhr = new XMLHttpRequest();
	xhr.open("GET", "/doublepress" , true);
	xhr.send()
}
function long_press(){
	var xhr = new XMLHttpRequest();
	xhr.open("GET", "/longpress" , true);
	xhr.send()
}
function set_delay(){
	var delay = document.getElementById("delay").value;
	console.log(delay);
	var xhr = new XMLHttpRequest();
	xhr.open("GET", "/delay?val=" + delay, true);
	xhr.send();
}
function reset_delay(){
	var xhr = new XMLHttpRequest();
	xhr.open("GET", "/resetdelay", true);
	xhr.send();
}
function save_delay(){
	var xhr = new XMLHttpRequest();
	xhr.open("GET", "/savedelay", true);
	xhr.send();
}
function save_config(){
	var xhr = new XMLHttpRequest();
	xhr.open("GET", "/saveconfig", true);
	xhr.send();
}
function off(){
	var xhr = new XMLHttpRequest();
	xhr.open("GET", "/off", true);
	xhr.send();
}
function reset(){
	var xhr = new XMLHttpRequest();
	xhr.open("GET", "/reset", true);
	xhr.send();
}
function reload(){
	var xhr = new XMLHttpRequest();
	xhr.open("GET", "/reload", true);
	xhr.send();
}
function charge(){
  var xhr = new XMLHttpRequest();
	xhr.open("GET", "/charge", true);
	xhr.send();
}

function enable(id){
  var xhr = new XMLHttpRequest();
  xhr.open("GET", "/enable?id=" + id, true);
	xhr.send();
}
function disable(id){
  var xhr = new XMLHttpRequest();
	xhr.open("GET", "/disable?id=" + id, true);
	xhr.send();
}

</script>
</body>
</html>